var container,stats,camera,scene,renderer,particles,SEPARATION=100,AMOUNTX=50,AMOUNTY=50,count=0,mouseX=0,mouseY=0,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2;function init(){container=document.createElement("div"),document.body.appendChild(container),(camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e4)).position.z=600,camera.position.y=200,scene=new THREE.Scene;for(var e=AMOUNTX*AMOUNTY,n=new Float32Array(3*e),t=new Float32Array(e),o=0,i=0,r=0;r<AMOUNTX;r++)for(var a=0;a<AMOUNTY;a++)n[o]=r*SEPARATION-AMOUNTX*SEPARATION/2,n[o+1]=0,n[o+2]=a*SEPARATION-AMOUNTY*SEPARATION/2,t[i]=1,o+=3,i++;var d=new THREE.BufferGeometry;d.setAttribute("position",new THREE.BufferAttribute(n,3)),d.setAttribute("scale",new THREE.BufferAttribute(t,1));var c=new THREE.ShaderMaterial({uniforms:{color:{value:new THREE.Color("#3b3de1")}},vertexShader:document.getElementById("vertexshader").textContent,fragmentShader:document.getElementById("fragmentshader").textContent});particles=new THREE.Points(d,c),scene.add(particles),(renderer=new THREE.WebGLRenderer({antialias:!0})).setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),container.appendChild(renderer.domElement),document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("touchstart",onDocumentTouchStart,!1),document.addEventListener("touchmove",onDocumentTouchMove,!1),window.addEventListener("resize",onWindowResize,!1)}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function onDocumentMouseMove(e){mouseX=e.clientX-windowHalfX,mouseY=e.clientY-windowHalfY}function onDocumentTouchStart(e){1===e.touches.length&&(e.preventDefault(),mouseX=e.touches[0].pageX-windowHalfX,mouseY=e.touches[0].pageY-windowHalfY)}function onDocumentTouchMove(e){1===e.touches.length&&(e.preventDefault(),mouseX=e.touches[0].pageX-windowHalfX,mouseY=e.touches[0].pageY-windowHalfY)}function animate(){requestAnimationFrame(animate),render()}function render(){camera.position.x+=.05*(mouseX-camera.position.x),camera.lookAt(scene.position);for(var e=particles.geometry.attributes.position.array,n=particles.geometry.attributes.scale.array,t=0,o=0,i=0;i<AMOUNTX;i++)for(var r=0;r<AMOUNTY;r++)e[t+1]=50*Math.sin(.3*(i+count))+50*Math.sin(.5*(r+count)),n[o]=8*(Math.sin(.3*(i+count))+1)+8*(Math.sin(.5*(r+count))+1),t+=3,o++;particles.geometry.attributes.position.needsUpdate=!0,particles.geometry.attributes.scale.needsUpdate=!0,renderer.render(scene,camera),count+=.1}init(),animate();